# Find employee with highest salary.
SELECT *
FROM EMPLOYEE
WHERE salary = (SELECT MAX(salary) FROM EMPLOYEE);


# Find second highest salary (Method 1 – Subquery)
SELECT MAX(salary)
FROM EMPLOYEE
WHERE salary < (SELECT MAX(salary) FROM EMPLOYEE);


# Find second highest salary (Method 2 – DENSE_RANK)
SELECT salary
FROM (
    SELECT salary, DENSE_RANK() OVER (ORDER BY salary DESC) AS rnk
    FROM EMPLOYEE
) t
WHERE rnk = 2;


Find employees earning more than department average.
SELECT *
FROM EMPLOYEE e
WHERE salary > (
    SELECT AVG(salary)
    FROM EMPLOYEE
    WHERE department = e.department
);
